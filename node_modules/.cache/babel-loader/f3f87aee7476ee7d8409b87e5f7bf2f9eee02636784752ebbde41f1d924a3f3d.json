{"ast":null,"code":"import firebase from'firebase/compat/app';import{FacebookAuthProvider}from'firebase/auth';import'firebase/compat/firestore';import'firebase/compat/auth';// Your web app's Firebase configuration\nconst Config={apiKey:\"AIzaSyASUJlnUutu5AN9CXXcxyAC1cwX7P_Ez54\",authDomain:\"chrome-ext-40d06.firebaseapp.com\",projectId:\"chrome-ext-40d06\",storageBucket:\"chrome-ext-40d06.firebasestorage.app\",messagingSenderId:\"681316511872\",appId:\"1:681316511872:web:5245c7dad8f6726b003665\"};// Initialize Firebase\nfirebase.initializeApp(Config);export const CreateUserProfileDocument=async(userAuth,additionalData)=>{if(!userAuth)return;// Fixed typo in path to user document\nconst userRef=firestore.doc(`user/${userAuth.uid}`);const snapshot=await userRef.get();if(!snapshot.exists){const{email,displayName,photoURL}=userAuth;const createdAt=new Date();try{await userRef.set({displayName,photoURL,email,createdAt,...additionalData});}catch(error){console.error('Error creating user profile',error.message);// Improved error logging\n}}return userRef;};// Export auth and firestore references\nexport const auth=firebase.auth();export const firestore=firebase.firestore();// Google Sign-in Provider\nconst googleProvider=new firebase.auth.GoogleAuthProvider();googleProvider.setCustomParameters({prompt:'select_account'});// export const SignInWithGoogle = () => auth.signInWithPopup(googleProvider);\nexport const SignInWithGoogle=navigate=>{auth.signInWithPopup(googleProvider).then(result=>{// Successful login\nnavigate('/library');}).catch(error=>{console.error('Error during Google authentication:',error.message);});};// Facebook Sign-in Provider\nconst facebookProvider=new FacebookAuthProvider();export const SignInWithFacebook=navigate=>{auth.signInWithPopup(facebookProvider).then(result=>{// Handle successful authentication\nnavigate('/library');console.log('Facebook user:',result.user);}).catch(error=>{// Handle errors\nif(error.code==='auth/popup-closed-by-user'){console.log('User closed the popup before completing the operation.');}else{console.error('Error during Facebook authentication:',error);}});};// Request custom Firebase token from your server\nexport const requestCustomToken=async uid=>{let storedUid=uid;try{const response=await fetch('https://helpmeout-be.vercel.app/generate-token',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({storedUid})});if(!response.ok)throw new Error('Failed to fetch custom token');const{token}=await response.json();return token;}catch(error){console.error('Error requesting custom token:',error.message);// More specific error message\nthrow error;}};const sendTokenToExtension=async uid=>{try{const token=await requestCustomToken(uid);// Assume you get the token here\n// Post message to the window (your extension's content script)\nwindow.postMessage({type:'SEND_TOKEN',token:token,uid},'*');// console.log(token,'UID:', uid)\n}catch(error){console.error('Failed to send token:',error);}};auth.onAuthStateChanged(user=>{if(user){// console.log(user);\n// CreateUserProfileDocument(user);\n}else{console.error('No user is signed in.');}});window.addEventListener('message',event=>{// Ensure the request is from the extension\nif(event.data.type!=='REQUEST_UID_AND_TOKEN')return;console.log('Received request for UID and token from content script');// Check if user is logged in\nconst user=auth.currentUser;if(user){console.log('User is logged in:',user.uid);sendTokenToExtension(user.uid);}else{console.error('No user signed in.');}});export default firebase;","map":{"version":3,"names":["firebase","FacebookAuthProvider","Config","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","initializeApp","CreateUserProfileDocument","userAuth","additionalData","userRef","firestore","doc","uid","snapshot","get","exists","email","displayName","photoURL","createdAt","Date","set","error","console","message","auth","googleProvider","GoogleAuthProvider","setCustomParameters","prompt","SignInWithGoogle","navigate","signInWithPopup","then","result","catch","facebookProvider","SignInWithFacebook","log","user","code","requestCustomToken","storedUid","response","fetch","method","headers","body","JSON","stringify","ok","Error","token","json","sendTokenToExtension","window","postMessage","type","onAuthStateChanged","addEventListener","event","data","currentUser"],"sources":["C:/Users/Admin/HelpMeOut-Ui/src/component/utils/firebase/firebase.js"],"sourcesContent":["\r\n\r\nimport firebase from 'firebase/compat/app';\r\nimport { FacebookAuthProvider } from 'firebase/auth';\r\nimport 'firebase/compat/firestore';\r\nimport 'firebase/compat/auth';\r\n\r\n// Your web app's Firebase configuration\r\nconst Config = {\r\n  apiKey: \"AIzaSyASUJlnUutu5AN9CXXcxyAC1cwX7P_Ez54\",\r\n  authDomain: \"chrome-ext-40d06.firebaseapp.com\",\r\n  projectId: \"chrome-ext-40d06\",\r\n  storageBucket: \"chrome-ext-40d06.firebasestorage.app\",\r\n  messagingSenderId: \"681316511872\",\r\n  appId: \"1:681316511872:web:5245c7dad8f6726b003665\"\r\n};\r\n\r\n// Initialize Firebase\r\nfirebase.initializeApp(Config);\r\n\r\nexport const CreateUserProfileDocument = async (userAuth, additionalData) => {\r\n  if (!userAuth) return;\r\n\r\n  // Fixed typo in path to user document\r\n  const userRef = firestore.doc(`user/${userAuth.uid}`);\r\n  const snapshot = await userRef.get();\r\n\r\n  if (!snapshot.exists) {\r\n    const { email, displayName, photoURL } = userAuth;\r\n    const createdAt = new Date();\r\n\r\n    try {\r\n      await userRef.set({\r\n        displayName,\r\n        photoURL,\r\n        email,\r\n        createdAt,\r\n        ...additionalData\r\n      });\r\n    } catch (error) {\r\n      console.error('Error creating user profile', error.message); // Improved error logging\r\n    }\r\n  }\r\n\r\n  return userRef;\r\n};\r\n\r\n// Export auth and firestore references\r\nexport const auth = firebase.auth();\r\nexport const firestore = firebase.firestore();\r\n\r\n// Google Sign-in Provider\r\nconst googleProvider = new firebase.auth.GoogleAuthProvider();\r\ngoogleProvider.setCustomParameters({ prompt: 'select_account' });\r\n\r\n// export const SignInWithGoogle = () => auth.signInWithPopup(googleProvider);\r\nexport const SignInWithGoogle = (navigate) => {\r\n  auth.signInWithPopup(googleProvider)\r\n      .then((result) => {\r\n          // Successful login\r\n          navigate('/library');\r\n      })\r\n      .catch((error) => {\r\n          console.error('Error during Google authentication:', error.message);\r\n      });\r\n};\r\n\r\n\r\n// Facebook Sign-in Provider\r\nconst facebookProvider = new FacebookAuthProvider();\r\n\r\nexport const SignInWithFacebook = (navigate) => {\r\n  auth.signInWithPopup(facebookProvider)\r\n    .then((result) => {\r\n      // Handle successful authentication\r\n      navigate('/library');\r\n      console.log('Facebook user:', result.user);\r\n    })\r\n    .catch((error) => {\r\n      // Handle errors\r\n      if (error.code === 'auth/popup-closed-by-user') {\r\n        console.log('User closed the popup before completing the operation.');\r\n      } else {\r\n        console.error('Error during Facebook authentication:', error);\r\n      }\r\n    });\r\n};\r\n\r\n// Request custom Firebase token from your server\r\nexport const requestCustomToken = async (uid) => {\r\n  let storedUid = uid;\r\n  try {\r\n    const response = await fetch('https://helpmeout-be.vercel.app/generate-token', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ storedUid })\r\n    });\r\n    \r\n    if (!response.ok) throw new Error('Failed to fetch custom token');\r\n    \r\n    const { token } = await response.json();\r\n    return token;\r\n  } catch (error) {\r\n    console.error('Error requesting custom token:', error.message); // More specific error message\r\n    throw error;\r\n  }\r\n};\r\nconst sendTokenToExtension = async (uid) => {\r\n  try {\r\n    const token = await requestCustomToken(uid);  // Assume you get the token here\r\n\r\n    // Post message to the window (your extension's content script)\r\n    window.postMessage({ type: 'SEND_TOKEN', token: token, uid }, '*');\r\n    // console.log(token,'UID:', uid)\r\n  } catch (error) {\r\n    console.error('Failed to send token:', error);\r\n  }\r\n};\r\nauth.onAuthStateChanged((user) => {\r\n  if (user) {\r\n  // console.log(user);\r\n  // CreateUserProfileDocument(user);\r\n    \r\n    \r\n  } else {\r\n    console.error('No user is signed in.');\r\n  }\r\n});\r\nwindow.addEventListener('message', (event) => {\r\n  // Ensure the request is from the extension\r\n  if (event.data.type !== 'REQUEST_UID_AND_TOKEN') return;\r\n\r\n  console.log('Received request for UID and token from content script');\r\n\r\n  // Check if user is logged in\r\n  const user = auth.currentUser;\r\n  if (user) {\r\n    console.log('User is logged in:', user.uid);\r\n    sendTokenToExtension(user.uid);\r\n  } else {\r\n    console.error('No user signed in.');\r\n  }\r\n});\r\n\r\nexport default firebase;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}